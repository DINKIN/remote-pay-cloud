<html>
<head>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Expires" content="0"/>

  <!-- following for testing only -->
  <script src="testConfigBase.js"></script>

  <script src="src/xmlHttpSupport.js"></script>
  <script src="src/CardEntryMethods.js"></script>
  <script src="src/CloverOAuth.js"></script>
  <script src="src/CloverError.js"></script>
  <script src="src/Clover.js"></script>
  <script src="src/WebSocketDevice.js"></script>
  <script src="src/Endpoints.js"></script>
  <script src="src/CloverID.js"></script>
  <script src="src/eventemitter3_v1_1_1.js"></script>
  <script src="src/RemoteMessageBuilder.js"></script>


  <link rel="stylesheet" type="text/css" href="appStyle.css">
</head>

<body>

<p>
  This is an example of the Clover High Level Cloud API.  It relies on the device to be running the
  Cloud Pay Display app.
  <br/>
</p>

<button onclick="clover.close()">Close Clover</button>
<button onclick="clover.device.deviceSocket.close()">Simulate network problem</button>
<button onclick="clover.initDeviceConnection(putAMessageOnDevice)">Init connection and put a message on device</button>

<!-- this is a place to talk about what is happening while the example is being run -->
<div id="uiFeedback" style="height: 400px;">
</div>

<script>

  // Create the Clover object to communicate with the device
  var configuration = Clover.loadConfigurationFromCookie("CLOVER_DEFAULT");
  configuration.allowOvertakeConnection = true;
  var clover = new Clover(configuration);

  var count = 0;

  // Start communication
  // Pass the function that should be called when the device is ready.
  clover.initDeviceConnection(putAMessageOnDevice);

  // This will be called when the device is ready
  function putAMessageOnDevice(error) {
    if(error) {
      var resultDisplay = "";
      resultDisplay += "<pre>"+JSON.stringify(error, null, 4) + "</pre>";
      document.getElementById("uiFeedback").innerHTML = resultDisplay;
    }
    clover.device.sendTerminalMessage("Message number " + count);
    count+=1;
  }
</script>

</body>
</html>
