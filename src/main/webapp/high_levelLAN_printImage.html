<html>
<head>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Expires" content="0"/>

  <script src="src/cloverCloud-min.js"></script>

  <link rel="stylesheet" type="text/css" href="appStyle.css">
</head>

<body>

<p>
  This is a simple example of the Clover High Level Cloud API. It assumes that the Clover device is running the
  Local Network Pay Display app at the address ws://192.168.1.3:14285. It makes a direct connection to the device
  and prints the image you see below.
</p>

<div>
  <img id="rct_img" src="img/clover.png" alt="Clover"/>
</div>

<script onbeforeunload="clover.close()">

  // Create the Clover object to communicate with the device
  var clover = new Clover({"deviceURL" : "ws://192.168.1.3:14285"});







  imageIsLoaded = false
  // Make sure the image is fully loaded.
  document.getElementById("rct_img").addEventListener("load", function() { imageLoaded(); });

  // Start communication
  deviceIsReady = false;
  // Pass the function that should be called when the device is ready.
  clover.initDeviceConnection(deviceReady);

  function imageLoaded() {
    imageIsLoaded = true;
    if(deviceIsReady) {
      printImg();
    }
  }

  function deviceReady(error) {
    if(error) {
      resultDisplay += "<pre>"+JSON.stringify(error, null, 4) + "</pre>";
    } else {
      deviceIsReady = true;
      if (imageIsLoaded) {
        printImg();
      }
    }
  }

  // This will be called when the device is ready
  function printImg() {
    var theImg = document.getElementById("rct_img");
    clover.printImage(theImg);
  }
</script>

</body>
</html>
